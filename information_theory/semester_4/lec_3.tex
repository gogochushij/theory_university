\lecture{3}{15 April}{\dag}
% \section{Подсчет углов в графе}
% \begin{figure}[ht]
%     \centering
%     \incfig{graph-image}
%     \caption{graph image}
%     \label{fig:graph-image}
% \end{figure}
% % Здесь нужно расписать что расписывается
% Чего в графе больше: углов или треугольников?
% \begin{note}
% 	Каждое ребро тоже угол, например, $ (x, y, y)$.
% \end{note}
% \begin{thm}
%     Число углов в графе всегда больше числа треугольников.
% \end{thm}
% \begin{proof}
% 	Выберем случайный треугольник $ T(x, y, z)$.
% \end{proof}

\section{Теория кодирования}
Код --- отображение алфавита $ C \colon \Sigma \to \{0, 1\}^{*}$.

Что хочется требовать?
\begin{enumerate}
    \item Однозначное декодирование. При этом не обязательно у каждой строки $ \{0, 1\}^{*}$ есть слово, но склейки нет.
	\item Префиксный код --- то есть код каждого символа не является префиксом кода другого. Очевидно, из этого следует предыдущий пункт.
\end{enumerate} 

\begin{thm}
    Любой однозначно декодируемый код можно переделать в префиксный с сохранением длин кодовых слов.
\end{thm}
\begin{proof}
	Пусть есть $  c_1, \ldots , c_n$ --- кодовые слова.

	Для префиксного кода $ \sum_{}^{} 2^{-\lvert c_i \rvert } \le 1$, причем, если если выполнено это неравенство, то есть префиксный код.

	Докажем, что для любого декодируемого кода выполнено такое неравенство.

	Построим многочлен для всех слов длины $ L$.

	\[
		p(x, y) = \left( \sum_{i}^{} p_i(x, y) \right) ^{L} = \sum_{j=L}^{} M_j(x, y)
	.\] 
	Здесь $ p_i(x, y)$ --- моном, соответствующий  $ i$-ому символу в алфавите и равный 

	Посчитаем $ p(\frac{1}{2}, \frac{1}{2})$.

	\[
		p(\tfrac{1}{2},\tfrac{1}{2}) = \sum_{j=L}^{} M_{j}(\tfrac{1}{2},\tfrac{1}{2}) \le \sum_{j=L}^{\max_{i} c_i}2^{j} \cdot 2 ^{-j} = \O(L)
	.\] 

	Посчитаем еще раз по второму представлению
	\[
		p(\tfrac{1}{2},\tfrac{1}{2}) = \left( \sum_{i}^{} 2^{-\lvert c_i \rvert } \right) ^{L}
	.\] 
	Если сумма в скобках больше $ 1$, получаем экспоненциальную оценку снизу.
	Следовательно, для больших $ N$ она обгонит линейную. Противоречие.
\end{proof}


\begin{thm}[Шеннон]
Пусть есть множество $ \Sigma $, и с вероятностью $ p_i$ получаем  $ i$-й символ.
   Тогда
   \[
	   \sum_{i}^{} p_i \lvert c_i \rvert  \ge H(p) \qquad  c_i \text{ --- однозначно декодируемы}
   .\] 
\end{thm}
\begin{proof}
	\begin{align*}
		H(p) - \sum_{i}^{} p_i \lvert c_i \rvert &= \sum_{}^{} p_i \log \frac{2^{-\lvert c_i \rvert }}{p_i} \le \tag{Неравенство Йенсена}\\
												 & \le  \log \sum_{}^{} p_i \cdot \frac{2^{-\lvert c_i \rvert }}{p_i} \le \tag{Неравенство Крафта} \\
												 & <= 0
	\end{align*}
\end{proof}


\begin{thm}[Шеннон]
	Существует такой код, что \footnote{Единичка обязательно возникает, так как мы приводим непрерывную энтропию к дискретной величине}
	\[
		\sum_{i}^{} p_i \cdot \lvert c_i \rvert \le H(p) + 1
	.\] 
\end{thm}
\begin{proof}
    Угадаем длины кодов, чтобы выполнялось неравенство ???.
	Пусть $  \lvert c_i \rvert = \lceil \log \frac{1}{p_i} \rceil$,
	\[
		\sum_{}^{} 2^{- \lvert c_i \rvert } = \sum_{}^{} 2^{- \rceil \frac{1}{p_i} \rceil} \le \sum_{}^{} p_i \le 1
	.\] 
\end{proof}

\section{Код Шенона-Фано}
Отсортируем вероятности по убыванию $  p_1 \ge p_2 \ge  \ldots \ge p_n$. Затем уложим их в отрезок $ [0, 1]$.

Разделим отрезок пополам и скажем, что слева кодовые слова начинается с  $ 0$, справа с  $ 1$, а центральный  $ p_i$ будет начинаться с нуля, если это $ p_1$, с единицы, если $ p_n$, и, наконец, иначе выдираем любое значение.

Далее рекурсивно запускаемся на группе нулей и на группе единиц.

Когда остался один кусок, останавливаемся.

\begin{thm}
	\[
		\sum_{0}^{n} p_i \cdot \lvert c_i \rvert  \le H(p) + \O(1), \quad n \to \infty, ~\O(1) \approx 3 \text{ или } 5 
	.\] 
\end{thm}
\begin{proof*}
    Упражнение со зведочкой.
\end{proof*}


\section{Код Хаффмана}
Опять отсортируем $  p_1 \ge  p_2 \ge  \ldots \ge p_n$. Возьмем $ p_{n-1}$ и $ p_n$. Заменим их на один символ с вероятностью  $ p_n + p_n-1$, теперь по индукции строим код для  $ n-1$ символа.

Теперь если объединенному символу соответствовал код  $  \overline{c}$, то для $ p_{n-1}$ задаем код  $ \overline{c 0}$, а для $ p_n$ код  $ \overline{c 1}$
 
Проверим, что $ \sum_{i=1}^{n} p_i \lvert c_i \rvert \le H(p) + 1$, причем $  \forall c'_i \colon \sum_{i=1}^{0} p_i \lvert c_i \rvert  \le \sum_{i=1}^{} p_i \lvert c_i \rvert $

Достаточно доказать второе, а потом сравнить с кодом Шеннона и получить нужное неравенство.

Рассмотрим набор $  c_1', \ldots c_n'$.  Возьмем два минимальных $ c_{n-1}'$ и $ c_n'$. Заметим, что можно поменять их с символами максимальной длины  $ c_i'$ и $ c_j'$, при этом длина кода не увеличится.

Изучим коды $ c_{n-1}'$ и $ c_n'$. Пусть они не имеют вид $ \overline{v 0}$ и $ \overline{v 1}$.
\begin{itemize}
	\item Пусть $ \lvert c_{n-1}' \rvert  \le  \lvert c_n' \rvert $. Посмотрим на $ c_{n-1}'$: не умаляя общности он будет заканчиваться на $ 0$ ( $ \overline{s 0}$ ). Заменим $ c_n'$ на $ s 1$. Если вдруг кто-то уже имел такой код, это и есть  $ c_n'$, так как имеет максимальную длину.

	% Написать подробнее!!!
\end{itemize}

\section{Арифметическое кодирование}
Уложим вероятности аналогично не отрезок, при этом не обязательно в порядке убывания.

Назовем \selectedFont{стандартным} интервал $ \bigl[\overline{0 v 0}, \overline{0 v 1}\bigr)$. Найдем максимальный стандартный интервал в отрезке $ p_i$. Тогда $ v$ будет кодом  $ p_i$.

\begin{proof*}
	Если рассмотреть отрезок $ [a, b]$, есть стандартный интервал длиной  $ \frac{b-a}{8}$. Упражнение
\end{proof*}

