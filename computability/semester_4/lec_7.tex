\lecture{7}{25 march}{\dag}
\begin{thm}\label{thm:malp}
	Частичная функция $ f \in \F^{(1)}_{ \alpha }$, где $  \alpha \colon \N \to  \N$ всюду определена, равносильно тому, что существует корректное множество троек $ M$, такое что  $ f = M[ \alpha ]$.
\end{thm}
\begin{proof}
~\begin{description}
	\item[\boxed{ 1 \Longrightarrow 2}] У нас есть алгоритм с оракулом $  \alpha $, вычисляющий $ f$. Построим $ M$.

		   Построим  дерево, моделирующее работу алгоритма на входе $ n$ по всем значениям оракула. Скорее всего, дерево будет бесконечным, с бесконечным числом веток.

		   Если на входе $ x$ возможен ответ $ y$, запишем тройку  $ (x, y, t)$ в  $ M$, где  $ t$ --- образец, содержащий все  ответы оракула на этой ветке.
		   \begin{itemize}
			   \item $ M$ перечислимо, так как можем стандартным образом давать поработать по $ k$ первым входам  $ k$ шагов, а  $ k$ увеличивать от  $ 0$ до  $  \infty$.
			   \item $ M$ корректно. Пусть  $ (x, y_1, t_1), (x, y_2, t_2) \in M$ и $  y_1 \ne y_2$. Эти тройки соответствуют разным путям в дереве (так как $  y_1 \ne y_2$), найдем вершину, где они разделились. В этом месте рассматриваются два разных ответа оракула, причем первый содержится в $  t_1$, а второй --- в $  t_2$, поэтому $  t_1$ и $  t_2$ несовместны.

				   Поэтому противоречивых троек нет.
		   \end{itemize}
		   Следовательно, $ M$ корректно.
	   \item Проверим, что $ f = M[ \alpha ]$. Пусть $ f(x) = y$. Это соответствует ветке дерева, начинающейся с входа $ x$ и заканчивающееся   $ y$, возможно с запросами к $  \alpha $.

		   Рассмотрим $ t$ --- образец, содержащий пары вопрос-ответ в этой ветке. $ t$ является частью  $ \alpha $, а $ (x, y, t) \in M$.

		   Значит, $ M[ \alpha ](x) $ определено и равно $ y$.
	   \item[\boxed{ 2 \Longrightarrow 1}] 
		   Пусть есть корректное перечислимое множество троек $ M$, такое  что $ f = M[ \alpha ]$.

		   Нужно построить алгоритм с оракулом $ \alpha $, считающий функцию $ f$.

		   На входе $ x$ запускаем алгоритм, перечисляющий  $ M$. Выбирает тройку, в которой первый элемент равен $ x$. 

		   Обозначим тройку $ (x, y, t)$. Так как  $ t$ конечное, по каждому элементу можем задать вопрос оракулу  $  \alpha $, тем самым проверим, что $ t$ является частью $  \alpha $.

		   Если да, то $ f(x) \coloneqq y$, иначе продолжаем спрашивать про следующий элемент.
		   Если <<да>> никогда не получаем, то функция не определена в этой точке.

		   В итоге мы построили алгоритм, который вычисляет $ M[ \alpha ]$.
   \end{description} 
\end{proof}

\begin{defn}
	Пусть $  \alpha $ --- перечислимое множество. Рассмотрим произвольное множество $ E$ пар  $ (x, t)$, где  $ x \in \N$ и $ t$ --- образец.
	\[
		E[ \alpha ] \coloneqq \{x \mid \exists (x, t) \in E, ~ t \text{ является частью } \alpha \}
	.\] 
\end{defn}

\begin{thm}[о характеризации относительной вычислимости]
	$ X$ --- $  \alpha $-перечислимое тогда и только тогда, когда существует перечислимое $ E$, такое что  $ X = E[ \alpha ]$.
\end{thm}
\begin{proof}
    ~\begin{description}
		\item[\boxed{ 1 \Longrightarrow 2}]
			Если $ X$ ---  $  \alpha $-перечислимое, то $ X$ --- область определения  $  \alpha $-вычислимой функции $ f$. По \hyperref[thm:malp]{предыдущей теореме} $ f = M[ \alpha ]$, для некоторого перечислимого корректного $ M$.

			Можем получить  $ E$ выкалыванием второй координаты из $ M$.

			Так как $ E[ \alpha ]$ является областью определения $ M[ \alpha ] = f$, $ E[ \alpha ] = X$.
        \item[\boxed{ 2 \Longrightarrow 1}]
			Пусть $ X = E[ \alpha ]$ для некоторого $ E$.

			Рассмотрим  $ M = \{(x, 0, t) \mid (x, t) \in  E\}$, оно корректно, поэтому соответствующая функция $ M[ \alpha ]$ будет определена на $ X = E[ \alpha ]$ и принимает только значение $ 0$.
    \end{description} 
\end{proof}

\noindent
Продолжим доказательство \hyperref[thm:main_thm]{главной теоремы}.
\begin{proof}\label{proof:main_thm}
	Сначала докажем, что $ \mathbb{O}'$ перечислимо и лежит в  $ \Sigma_2$.

	Пусть  $ A$ является $ \mathbb{O}'$-перечислимым. По определению $ A $ перечислимо относительно некоторого перечислимого $ B$. То есть оно перечислимо относительно  $ \xi_B$.

	По теореме о характеристике относительной вычислимости, существует перечислимое множество $ Q$ пар вида $ (x, t)$,  где $ x \in \N$ и $ t$ --- образец, такое что 
	\[
		x \in A \Longleftrightarrow \exists t \colon (x, t) \in Q, \xi_B \text{ продолжает } t
	.\] 
	Можем считать, что
	\begin{itemize}
		\item  <<$ \xi_B$ продолжает $ t$>> означает, что $ B$ содержит множество, на котором  $ t = 1$, и не пересекается с множеством, на котором  $ t = 0$
		\item функция, соответствующая $ t$, принимает только $ 0$ и $ 1$, так как иначе $ \xi_B$ не сможет ее продолжить
	\end{itemize}
	Поэтому вместо \textit{образцов} в данном случае можно рассматривать \textit{пары конечных множество} и вместо \textit{множества пар $ Q$} --- \textit{множество $ P$ троек} $ (x, u, v)$, где 
	\[
		x \in A \Longleftrightarrow \exists u \exists v \Bigl( (x, u,v) \in P \wedge
			\underbrace{D_u \subset B}_{\stackrel{\rotatebox[origin=c]{90}{$\Leftrightarrow$}}{u \in \Subsetm(B)}} \wedge 
		\underbrace{D_v \cap B = \varnothing}_{\stackrel{\rotatebox[origin=c]{90}{$\Leftrightarrow$}}{v \in  \Disjointm(B)}} \Bigr) 
	.\] 

	Так как $ P$ перечислимо,  $ P \in \Sigma_1$, второе свойство ($u \in  \Subsetm(B)$) по лемме о $ \Subsetm$ принадлежит  $ \Sigma_1$, а третье  $ v \in \Disjointm(B)$ принадлежит $ \Pi_1$ по лемме о \ $ \Disjointm$.

	То есть все условие в скобках принадлежит  $ \Sigma_2$, поэтому и вся правая часть из  $ \Sigma_2$.  Доказали для  $ n = 2$.
	
	Дальше действуем аналогично, заменив  $ 2$ на  $ n$.
\end{proof}

\begin{cor}
	$ \Sigma_n \cap \Pi_n = \{\mathbb{O}^{(n-1)} \text{-разрешимые}\}$
\end{cor}
\begin{proof}
    Релятивизованная теорема Поста.
\end{proof}
\begin{cor}
    $ \Sigma_n \cup \Pi_n \subsetneq \Sigma_{n+1} \cap \Pi_{n+1}$ для $ n > 0$
\end{cor}
\begin{proof}
	По определению $ \mathbb{O}^{(n)}$ это степень $ m$-полного множества  $ X$ в классе  $ \mathbb{O}^{(n-1)}$-перечислимых.

	Если $ X$ является $ m$-полным, то не разрешимо в этом классе, поэтому $ \overline{X}$ не является перечислимым в этом классе.

	По теореме об арифметической иерархии $ x \in \Sigma_n$, $ \overline{X} \in \Pi_n$ и $ \overline{X} \notin \Sigma_n$.

	Рассмотрим $ A = \{2n \mid n \in X\} \cup \{2n+1 \mid n \notin X\}$. Так как к $ A$ сводится и $ X$, и  $ \overline{X}$, $ A \notin \Sigma_n$ и $ A \notin \Pi_n$. Значит, $ A \in \Sigma_{n+1} \cap \Pi_{n+1}$. 
\end{proof}


\section{Классификация множеств в иерархии}
\begin{thm}
    Множество номеров нигде не определенной функции в главной нумерации $ \Pi_1$-полное
\end{thm}
\begin{proof}
    Упражнение. Подсказка: его дополнение $ \Sigma_1$-полное
\end{proof}

\begin{thm}
    \begin{enumerate}
        \item Если $ U \in \F^2$ --- универсальное для $ \F$. Тогда 
			$$ \{n \mid U_n \text{ всюду определено тождественно равным 0} \} \in \Pi_2 $$
		\item  Если $ U$ --- главная, то это множество $ \Pi_2$-полное.
    \end{enumerate} 
\end{thm}
\begin{proof}
    \begin{enumerate}
        \item Пусть 
			\[
				A = \{n \mid \forall k ~\exists t ~ U(n, k) \text{ заканчивает работу за $ t $ шагов и выдает  $ 0$}\}
			.\] 
			Это $  \Pi_2$.
		\item Докажем, что к нему сводится произвольное множество из из $ \Pi_2$, то есть
			 \[
			 x \in P \Longleftrightarrow \forall y ~ \exists z \underbrace{R(x, y, z) }_{\text{разрешимо}}
			.\] 
			Рассмотрим $ S(x, y)$, которая перебирает  $ z$ и ищет такое, что  $ R(x, y, z)$ выполнено. Если нашли, возвращаем  $ 0$. 

То есть $ S_x \equiv 0 \Longleftrightarrow x \in P$.

Так как $ U$ главная нумерация,  $ \exists s \colon U_{s(x)} = S_x$. То есть $ s$ сводит  $ P$ к множеству номеров, которое тождественно  нулевой функции.
    \end{enumerate} 
\end{proof}

Пример на третьем слое --- множества с конечными дополнениями.
\begin{probl}
    Пусть $ f$ --- вычислимая функция, $ U$ --- главная нумерация. $ A = \{n \mid U_n = f\}$.

	Найти минимальный класс для множества $ A$ (он зависит от функции).
\end{probl}
